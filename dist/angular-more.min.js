/*!
 * @bndynet/angular-more v2.2.5 (https://github.com/bndynet/angular-more#readme)
 * (c) 2014-2018 Bndy.Net (http://bndy.net)
 */

"use strict";angular.module("bn.ui",["ngSanitize","ui.bootstrap.datetimepicker","ui.dateTimeInput"]),angular.module("bn.ui").filter("appDate",function(){return function(a){return moment(a).isValid()?"zh-cn"===moment.locale()?moment(a).format("YYYY-M-D"):moment(a).format("l"):""}}).filter("appDateTime",function(){return function(a){return moment(a).isValid()?"zh-cn"===moment.locale()?moment(a).format("YYYY-M-D HH:mm:ss"):moment(a).format("lll"):""}}).filter("appFullDateTime",function(){return function(a){return moment(a).isValid()?"zh-cn"===moment.locale()?moment(a).format("llll"):moment(a).format("llll"):""}}),angular.module("bn.ui").directive("bnUiChecks",function(){return{restrict:"E",scope:{nbModel:"=?",nbLabel:"@",nbSource:"=",nbTextField:"@",nbValueField:"@",nbMultiple:"=?",nbWithIcon:"=?",nbShowButton:"=?",nbOnChange:"&?"},template:'<div class="form-group">\n    <label ng-bind-html="nbLabel" ng-if="nbLabel"></label>\n    <div>\n        <div class="{{nbShowButton ? \'btn-group\' : \'form-control-static\'}}">\n            <label ng-class="{\'btn btn-default\': nbShowButton, \'active\': nbShowButton && isExisted(item)}" ng-repeat="item in nbSource"\n                ng-class="{active: isExisted(item)}" ng-click="itemClick(item)">\n                <i class="glyphicon fa fa-fw {{nbMultiple?\'glyphicon-check fa-check-square-o\':\'glyphicon-check fa-dot-circle-o\'}}" ng-show="isExisted(item) && showIcon()"></i>\n                <i class="glyphicon fa fa-fw {{nbMultiple?\'glyphicon-unchecked fa-square-o\':\'glyphicon-unchecked fa-circle-o\'}}" ng-show="!isExisted(item) && showIcon()"></i>\n                <span>{{getItemText(item)}}</span>\n            </label>\n        </div>\n    </div>\n</div>',link:function(a,b,c){var d,e;d=[],"undefined"==typeof a.nbModel&&(a.nbModel=a.nbMultiple?[]:null),e=function(){return a.nbMultiple?(a.nbModel.length=0,angular.forEach(d,function(b){return a.nbModel.push(b[a.nbValueField])})):a.nbModel=d.length>0?d[0][a.nbValueField]:null},a.nbModel&&(angular.isArray(a.nbModel)?angular.forEach(a.nbModel,function(b){return angular.forEach(a.nbSource,function(c){if(c[a.nbValueField]===b)return d.push(c)})}):angular.forEach(a.nbSource,function(b){if(b[a.nbValueField]===a.nbModel)return d.push(b)})),"undefined"==typeof a.nbMultiple&&(a.nbMultiple=!1),"undefined"==typeof a.nbWithIcon&&(a.nbWithIcon=!1),a.nbWithIcon||(a.nbShowButton=!0),a.$watch("nbWithIcon",function(b){if(!b)return a.nbShowButton=!0}),a.$watch("nbShowButton",function(b){if(!b)return a.nbWithIcon=!0}),a.showIcon=function(){return"undefined"!=typeof a.nbWithIcon&&a.nbWithIcon},a.isExisted=function(b){return 0!==d.length&&(a.nbMultiple?d.indexOf(b)>=0:d.length>0&&d[0]===b)},a.getItemText=function(b){return b[a.nbTextField]},a.itemClick=function(b){if(a.nbMultiple?d.indexOf(b)<0?d.push(b):d.splice(d.indexOf(b),1):(d.length=0,d.push(b)),e(),a.nbOnChange)return a.nbOnChange({data:a.nbModel})}}}}),angular.module("bn.ui").directive("bnUiColorpicker",function(){return{restrict:"E",scope:{nbColors:"=",nbModel:"=?",nbOnChange:"&?"},template:'<span class="dropdown">\n  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">\n      <span class="empty" ng-show="nbModel == null || typeof(nbModel) == \'undefined\'"></span>\n      <span ng-style="{\'background-color\': color.value}" ng-class="color.css" ng-show="color.key == nbModel" ng-repeat="color in nbColors" title="{{color.description}}"></span>\n  </a>\n  <ul class="dropdown-menu" ng-class="{inline: inline}">\n      <li ng-repeat="color in nbColors">\n          <a role="button" ng-click="nbOnChange({data: color})">\n              <span class="flag" style="" ng-class="color.css" ng-style="{\'background-color\': color.value}"></span>\n              <span ng-bind="color.description"></span>\n          </a>\n      </li>\n  </ul>\n</span>',link:function(a,b,c){var d,e,f,g,h;for(f=!0,h=a.nbColors,e=0,g=h.length;e<g;e++)if(d=h[e],d.description){f=!1;break}a.inline=f}}}),angular.module("bn.ui").directive("bnUiHtmlEditor",function(){return{restrict:"E",require:"?ngModel",link:function(a,b,c,d){var e,f;if("undefined"==typeof CKEDITOR)throw new Error("Can not find CKEDITOR");CKEDITOR.config.height=360,e=CKEDITOR.replace(elm[0]),d&&(e.on("instanceReady",function(){return e.setData(d.$viewValue)}),f=function(){return a.$apply(function(){return d.$setViewValue(e.getData())})},e.on("change",f),e.on("key",f),e.on("dataReady",f),d.$render=function(a){return e.setData(d.$viewValue)})}}}),angular.module("bn.ui").directive("bnUiInput",[function(){return{restrict:"E",replace:!0,transclude:!0,require:"ngModel",scope:{ngModel:"=ngModel",label:"@label",addon:"@addon",type:"@type",format:"@format"},template:'<div class="bn-ui-input form-group">\n    <label ng-bind-html="label" ng-if="label"></label>\n    <div class="dropdown" ng-if="type==\'datetime\'||type==\'date\'">\n        <a class="dropdown-toggle" id="btn_{{tagId}}" role="button" data-toggle="dropdown" data-target="#" href="#">\n            <div class="input-group">\n                <input type="text" class="form-control" data-ng-model="ngModel" data-date-time-input="{{format}}" readonly>\n                <span class="input-group-addon">\n                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i>\n                </span>\n            </div>\n        </a>\n        <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n            <datetimepicker data-ng-model="ngModel" \n                data-on-set-time="onTimeSet(newDate, oldDate)"\n                data-datetimepicker-config="{ dropdownSelector: \'#btn_\' + tagId, startView:\'day\', minView: type==\'date\' ? \'day\' : \'minute\' }" />\n        </ul>\n    </div>\n    <div class="{{addon?\'input-group\':\'\'}}" ng-if="type!=\'datetime\'&&type!=\'date\'">\n        <input type="{{type}}" class="form-control" ng-model="ngModel" />\n        <div class="input-group-addon" ng-if="addon" ng-bind-html="addon"></div>\n    </div>\n</div>',controller:["$scope","$element","$transclude",function(a,b,c){return a.tagId=parseInt(1e6*Math.random()),c(function(b){var c,d,e,f;for(d=0,f=b.length;d<f;d++)e=b[d],"ADDON"===e.tagName&&(c=e);c&&(a.addon=c.innerHTML)})}],compile:function(a,b,c){if(""===b.required||"true"===b.required)return a.find("input").attr("required",!0)}}}]),angular.module("bn.ui").directive("bnUiLoading",["$compile",function(a){return{restrict:"A",link:function(b,c,d){var e,f,g;c.css("width",c.outerWidth()),c.css("height",c.outerHeight()),g=!0,("BUTTON"===c[0].tagName.toLocaleUpperCase()||"A"===c[0].tagName.toLocaleUpperCase()||c.attr("ng-click"))&&(g=!1),f=g?"opacity-lg":"",e=a(c.contents())(b),b.$watch(d.bnUiLoading,function(a){if(c.attr("disabled",a),a){if(c.prepend("<div class='in-process "+f+"'><div><i class='bounce1'></i><i class='bounce2'></i><i class='bounce3'></i></div></div>"),g)return;return angular.forEach(e,function(a){return"#text"===angular.element(a)[0].nodeName?angular.element(a).remove():angular.element(a).css("visibility","hidden")})}if(angular.element(document.querySelector(".in-process")).remove(),!g)return angular.forEach(e,function(a){return"#text"===angular.element(a)[0].nodeName?c.append(a):angular.element(a).css("visibility","visible")})})}}}]),angular.module("bn.ui").directive("bnUiPager",function(){return{restrict:"E",template:'<div class="bn-ui-pager" ng-show="model.recordCount > 0">\n    <div class="summary" ng-show="showSummary">\n        <span ng-bind="(model.currentPage - 1) * model.pageSize + 1"></span>\n        - <span ng-bind="model.currentPage * model.pageSize > model.recordCount ? model.recordCount : model.currentPage * model.pageSize"></span>\n        / <span ng-bind="model.recordCount"></span>\n    </div>\n    <nav aria-label="Page navigation">\n      <ul class="pagination" ng-show="model.pageCount > 1">\n        <li ng-class="{disabled: model.currentPage == 1}">\n          <a aria-label="Previous" ng-click="page(model.currentPage-1)">\n            <span aria-hidden="true">&laquo;</span>\n          </a>\n        </li>\n        <li ng-repeat="p in model.displayPageNumbers track by $index" ng-class="{active: model.currentPage == p, disabled: p < 0}">\n          <a ng-show="p > 0" ng-click="page(p)"><span ng-bind="p"></span></a>\n          <a ng-show="p < 0">...</a>\n        </li>\n        <li ng-class="{disabled: model.currentPage == model.pageCount}">\n          <a aria-label="Next" ng-click="page(model.currentPage+1)">\n            <span aria-hidden="true">&raquo;</span>\n          </a>\n        </li>\n      </ul>\n    </nav>\n</div>',replace:!0,scope:{model:"=ngModel",onPage:"&onPage"},link:function(a,b,c){"undefined"==typeof a.model&&(a.model={}),a.showSummary="undefined"==typeof c.showSummary||"true"===c.showSummary,a.$watch("model",function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(b&&("undefined"==typeof a.model.pageCount&&(a.model.pageCount=Math.ceil(a.model.recordCount/a.model.pageSize)),"undefined"==typeof a.model.displayPageNumbers))if(a.model.displayPageNumbers=[],a.model.pageCount<=10)for(m=d=1,o=a.model.pageCount;1<=o?d<=o:d>=o;m=1<=o?++d:--d)a.model.displayPageNumbers.push(m);else if(a.model.currentPage<=5){for(m=e=1;e<=7;m=++e)a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=f=p=a.model.pageCount-1,r=a.model.pageCount;p<=r?f<=r:f>=r;m=p<=r?++f:--f)a.model.displayPageNumbers.push(m)}else if(a.model.currentPage>a.model.pageCount-5){for(s=[1,2],g=0,h=s.length;g<h;g++)m=s[g],a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=j=t=a.model.pageCount-6,u=a.model.pageCount;t<=u?j<=u:j>=u;m=t<=u?++j:--j)a.model.displayPageNumbers.push(m)}else{for(v=[1,2],k=0,i=v.length;k<i;k++)m=v[k],a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=l=w=a.model.currentPage-2,x=a.model.currentPage+2;w<=x?l<=x:l>=x;m=w<=x?++l:--l)a.model.displayPageNumbers.push(m);for(a.model.displayPageNumbers.push(-1),m=n=y=a.model.pageCount-1,q=a.model.pageCount;y<=q?n<=q:n>=q;m=y<=q?++n:--n)a.model.displayPageNumbers.push(m)}}),a.page=function(b){b<=0&&(b=1),b>a.model.pageCount&&(b=a.model.pageCount),a.model.currentPage!==b&&(a.onPage&&a.onPage({page:b}),a.model.currentPage=b)}}}}),angular.module("bn.ui").directive("bnUiSearch",[function(){return{restrict:"E",scope:{nbModel:"=",nbPlaceholder:"@?",nbOnChange:"&?"},template:'<div>\n    <i class="glyphicon glyphicon-search fa fa-search"></i>\n    <input type="text" ng-model="nbModel" class="form-control" placeholder="{{nbPlaceholder}}" ng-change="nbOnChange({data: nbModel})" />\n    <span class="ng-cloak" role="button" ng-show="nbModel" ng-click="nbModel=null;nbOnChange({data: nbModel})">&times;</span>\n</div>'}}]),angular.module("bn.ui").directive("bnUiSelect",[function(){return{restrict:"E",scope:{nbModel:"=",nbSource:"=",nbTextField:"@",nbValueField:"@",nbLabel:"@?",nbMultiple:"=?",nbPlaceholder:"@?",nbOnChange:"&?"},template:'<div class="form-group">\n    <label ng-bind-html="nbLabel" ng-if="nbLabel"></label>\n    <a class="form-control" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n        <span class="placeholder" ng-if="selectedItems.length === 0">{{nbPlaceholder}}</span>\n        <span class="label label-primary" ng-repeat="item in selectedItems track by $index">\n            <span>{{item[nbTextField]}}</span>\n        </span>\n        <span class="caret"></span>\n    </a>\n    <ul class="dropdown-menu" aria-labelledby="dLabel">\n        <li class="placeholder" ng-if="nbPlaceholder && !nbMultiple">\n            <a ng-click="onchange(null)">{{nbPlaceholder}}</a>\n        </li>\n        <li ng-repeat="item in nbSource track by $index">\n            <a ng-click="onchange(item)">\n                <i class="glyphicon glyphicon-ok" aria-hidden="true" ng-show="item.__selected"></i>\n                <span>{{item[nbTextField]}}</span>\n            </a>\n        </li>\n    </ul>\n</div>',link:function(a,b,c){a.selectedItems=[],a.nbModel&&angular.forEach(a.nbSource,function(b){angular.isArray(a.nbModel)?angular.forEach(a.nbModel,function(c){if(c===b[a.nbValueField])return b.__selected=!0,a.selectedItems.push(b)}):b[a.nbValueField]===a.nbModel&&(b.__selected=!0,a.selectedItems.push(b))}),a.onchange=function(b){var c,d,e,f,g,h,i,j,k,l,m,n;if(!b&&!a.nbMultiple){for(j=a.nbSource,c=0,g=j.length;c<g;c++)d=j[c],d.__selected=!1;return a.selectedItems.length=0,void(a.nbModel=null)}if(!b.__selected||a.nbMultiple){if(!a.nbMultiple)for(k=a.nbSource,e=0,h=k.length;e<h;e++)d=k[e],d.__selected=!1;for(b.__selected=!b.__selected,b.__selected?a.nbMultiple?a.selectedItems.indexOf(b)<0&&a.selectedItems.push(b):(a.selectedItems.length=0,a.selectedItems.push(b)):a.selectedItems.indexOf(b)>=0&&a.selectedItems.splice(a.selectedItems.indexOf(b),!b.__selected),n=[],l=a.selectedItems,f=0,i=l.length;f<i;f++)m=l[f],n.push(m[a.nbValueField]);n.length>0?a.nbModel=a.nbMultiple?angular.copy(n):n[0]:a.nbMultiple?a.nbModel=angular.copy([]):a.nbModel=null,a.nbOnChange&&a.nbOnChange({data:a.nbModel})}}}}}]),angular.module("bn.ui").directive("bnUiSwitch",[function(){return{restrict:"E",scope:{nbModel:"=",nbOnChange:"&?"},template:'<span ng-class="{on: nbModel}" ng-click="change();">\n    <span class="indicator"></span>\n</span>',link:function(a,b,c){return a.change=function(){if(a.nbModel=!a.nbModel,angular.isFunction(a.nbOnChange))return a.nbOnChange({data:a.nbModel})}}}}]),angular.module("bn.ui").directive("bnFillHeight",[function(){return{restrict:"A",link:function(a,b,c){return b.css("height",b.parent().height())}}}]);